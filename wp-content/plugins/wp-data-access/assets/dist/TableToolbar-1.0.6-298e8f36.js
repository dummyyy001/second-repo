import{r as _,ce as V,aO as yt,l as H,j as g,cw as ht,bb as bt,br as Tt,cf as St,bL as wt,e as se,C as he}from"./main-1.0.6.js";import{u as Et,v as xt,B as Te,k as jt,a2 as Ot,T as _t,af as Rt,a4 as Ct}from"./main-1.0.6-7aa8b30c.js";import{P as ee}from"./DialogContent-1.0.6-e7b9fcb3.js";import{e as At,f as Lt}from"./index.esm-1.0.6-f58f385b.js";import{d as Nt}from"./ActionsDml-1.0.6-4c91d556.js";import{C as kt}from"./settings-1.0.6-c1644694.js";import{u as Bt}from"./TableContainer-1.0.6-209eb742.js";import{B as ue}from"./AdminTheme-1.0.6-6896de59.js";import{P as Pt}from"./TextField-1.0.6-b41aa978.js";import{T as Ft,I as Mt}from"./iconBase-1.0.6-b8af29f5.js";import{R as It}from"./RadioGroup-1.0.6-adb96ecd.js";import{F as W}from"./FormControlLabel-1.0.6-72a72881.js";import{R as Y}from"./Radio-1.0.6-2befae95.js";import"./Close-1.0.6-4b5eac8d.js";import"./Tabs-1.0.6-e49ea330.js";import"./index.esm-1.0.6-8607d2e4.js";import"./MenuItem-1.0.6-b9a91535.js";import"./Checkbox-1.0.6-26443287.js";import"./AlertTitle-1.0.6-986ff958.js";import"./useSlot-1.0.6-8db722c4.js";import"./InputAdornment-1.0.6-f8c6f282.js";import"./DateTimePicker-1.0.6-71307f11.js";import"./useMobilePicker-1.0.6-328fb89a.js";import"./date-time-utils-1.0.6-04701755.js";import"./dateViewRenderers-1.0.6-faae157e.js";import"./TimePicker-1.0.6-dfb27941.js";import"./DatePicker-1.0.6-75aa4c76.js";import"./ScopeEnum-1.0.6-035f2615.js";import"./useStoreTable-1.0.6-edd54d94.js";import"./index.esm-1.0.6-d540f227.js";import"./index-1.0.6-601a5223.js";import"./vi-1.0.6-f3183323.js";import"./dayjs.min-1.0.6-fcad92ca.js";function te(t){if(typeof window>"u")return t;const n=_.useRef(null);return _.useLayoutEffect(()=>{n.current=t}),_.useCallback((...i)=>{var s;(s=n.current)===null||s===void 0||s.call(n,...i)},[])}const Ie={};function Ut(t,n){Ie[t]||(Ie[t]=!0,console.error("[material-ui-popup-state] WARNING",n))}const qt={isOpen:!1,setAnchorElUsed:!1,anchorEl:void 0,anchorPosition:void 0,hovered:!1,focused:!1,_openEventType:null,_childPopupState:null,_deferNextOpen:!1,_deferNextClose:!1};function Ht({parentPopupState:t,popupId:n,variant:i,disableAutoFocus:s}){const y=_.useRef(!0);_.useEffect(()=>(y.current=!0,()=>{y.current=!1}),[]);const[h,v]=_.useState(qt),u=_.useCallback(l=>{y.current&&v(l)},[]),j=_.useCallback(l=>u(a=>({...a,setAnchorElUsed:!0,anchorEl:l??void 0})),[]),c=te(l=>(h.isOpen?m(l):d(l),h)),d=te(l=>{const a=l instanceof Element?void 0:l,b=l instanceof Element?l:(l==null?void 0:l.currentTarget)instanceof Element?l.currentTarget:void 0;if((a==null?void 0:a.type)==="touchstart"){u(O=>({...O,_deferNextOpen:!0}));return}const B=a==null?void 0:a.clientX,I=a==null?void 0:a.clientY,X=typeof B=="number"&&typeof I=="number"?{left:B,top:I}:void 0,G=O=>{if(!l&&!O.setAnchorElUsed&&i!=="dialog"&&Ut("missingEventOrAnchorEl","eventOrAnchorEl should be defined if setAnchorEl is not used"),t){if(!t.isOpen)return O;setTimeout(()=>t._setChildPopupState(N))}const U={...O,isOpen:!0,anchorPosition:X,hovered:(a==null?void 0:a.type)==="mouseover"||O.hovered,focused:(a==null?void 0:a.type)==="focus"||O.focused,_openEventType:a==null?void 0:a.type};return a!=null&&a.currentTarget?O.setAnchorElUsed||(U.anchorEl=a==null?void 0:a.currentTarget):b&&(U.anchorEl=b),U};u(O=>O._deferNextOpen?(setTimeout(()=>u(G),0),{...O,_deferNextOpen:!1}):G(O))}),E=l=>{const{_childPopupState:a}=l;return setTimeout(()=>{a==null||a.close(),t==null||t._setChildPopupState(null)}),{...l,isOpen:!1,hovered:!1,focused:!1}},m=te(l=>{const a=l instanceof Element?void 0:l;if((a==null?void 0:a.type)==="touchstart"){u(b=>({...b,_deferNextClose:!0}));return}u(b=>b._deferNextClose?(setTimeout(()=>u(E),0),{...b,_deferNextClose:!1}):E(b))}),x=_.useCallback((l,a)=>{l?d(a):m(a)},[]),M=te(l=>{const{relatedTarget:a}=l;u(b=>b.hovered&&!(a instanceof Element&&Se(a,N))?b.focused?{...b,hovered:!1}:E(b):b)}),T=te(l=>{if(!l)return;const{relatedTarget:a}=l;u(b=>b.focused&&!(a instanceof Element&&Se(a,N))?b.hovered?{...b,focused:!1}:E(b):b)}),S=_.useCallback(l=>u(a=>({...a,_childPopupState:l})),[]),N={...h,setAnchorEl:j,popupId:n,variant:i,open:d,close:m,toggle:c,setOpen:x,onBlur:T,onMouseLeave:M,disableAutoFocus:s??!!(h.hovered||h.focused),_setChildPopupState:S};return N}function Xt({isOpen:t,popupId:n,variant:i}){return{...i==="popover"?{"aria-haspopup":!0,"aria-controls":t&&n!=null?n:void 0}:i==="popper"?{"aria-describedby":t&&n!=null?n:void 0}:void 0}}function Gt(t){return{...Xt(t),onClick:t.open,onTouchStart:t.open}}function Jt({isOpen:t,anchorEl:n,anchorPosition:i,close:s,popupId:y,onMouseLeave:h,disableAutoFocus:v,_openEventType:u}){return{id:y,anchorEl:n,anchorPosition:i,anchorReference:u==="contextmenu"?"anchorPosition":"anchorEl",open:t,onClose:s,onMouseLeave:h,...v&&{disableAutoFocus:!0,disableEnforceFocus:!0,disableRestoreFocus:!0}}}function $t(t,{popupId:n}){if(!n)return null;const i=typeof t.getRootNode=="function"?t.getRootNode():document;return typeof i.getElementById=="function"?i.getElementById(n):null}function Se(t,n){const{anchorEl:i,_childPopupState:s}=n;return Ue(i,t)||Ue($t(t,n),t)||s!=null&&Se(t,s)}function Ue(t,n){if(!t)return!1;for(;n;){if(n===t)return!0;n=n.parentElement}return!1}function Ge({children:t,popupId:n,variant:i,parentPopupState:s,disableAutoFocus:y}){const h=Ht({popupId:n,variant:i,parentPopupState:s,disableAutoFocus:y}),v=t(h);return v??null}Ge.propTypes={children:ee.func.isRequired,popupId:ee.string,variant:ee.oneOf(["popover","popper"]).isRequired,parentPopupState:ee.object,disableAutoFocus:ee.bool};var Kt={fieldSeparator:",",decimalSeparator:".",quoteStrings:!0,quoteCharacter:'"',showTitle:!1,title:"My Generated Report",filename:"generated",showColumnHeaders:!0,useTextFile:!1,useBom:!0,columnHeaders:[],useKeysAsHeaders:!1,boolDisplay:{true:"TRUE",false:"FALSE"},replaceUndefinedWith:""},Wt=`\r
`,Yt="\uFEFF",we=t=>Object.assign({},Kt,t);class Vt extends Error{constructor(n){super(n),this.name="CsvGenerationError"}}class zt extends Error{constructor(n){super(n),this.name="EmptyHeadersError"}}class Qt extends Error{constructor(n){super(n),this.name="CsvDownloadEnvironmentError"}}var re=t=>t,k=t=>t,le=re,z=re,qe=re,He=re,Zt=function(t,n){return n=='"'&&t.indexOf('"')>-1?t.replace(/"/g,'""'):t},Dt=t=>qe(typeof t=="object"?t.key:t),er=t=>He(typeof t=="object"?t.displayLabel:t),tr=(t,...n)=>n.reduce((i,s)=>s(i),t),rr=t=>n=>t.useBom?le(k(n)+Yt):n,nr=t=>n=>t.showTitle?Ee(le(k(n)+t.title))(z("")):n,Ee=t=>n=>le(k(t)+k(n)+Wt),Je=t=>(n,i)=>or(t)(z(n+i)),or=t=>n=>re(k(n)+t.fieldSeparator),ir=(t,n)=>i=>{if(!t.showColumnHeaders)return i;if(n.length<1)throw new zt("Option to show headers but none supplied. Make sure there are keys in your collection or that you've supplied headers through the config options.");let s=z("");for(let y=0;y<n.length;y++){const h=er(n[y]);s=Je(t)(s,$e(t,h))}return s=z(k(s).slice(0,-1)),Ee(i)(s)},ar=(t,n,i)=>s=>{let y=s;for(var h=0;h<i.length;h++){let v=z("");for(let u=0;u<n.length;u++){const j=Dt(n[u]),c=typeof i[h][k(j)]>"u"?t.replaceUndefinedWith:i[h][k(j)];v=Je(t)(v,$e(t,c))}v=z(k(v).slice(0,-1)),y=Ee(y)(v)}return y},Xe=t=>+t===t&&(!isFinite(t)||!!(t%1)),$e=(t,n)=>{if(t.decimalSeparator==="locale"&&Xe(n))return n.toLocaleString();if(t.decimalSeparator!=="."&&Xe(n))return n.toString().replace(".",t.decimalSeparator);if(typeof n=="string"){let i=n;return(t.quoteStrings||t.fieldSeparator&&n.indexOf(t.fieldSeparator)>-1||t.quoteCharacter&&n.indexOf(t.quoteCharacter)>-1||n.indexOf(`
`)>-1||n.indexOf("\r")>-1)&&(i=t.quoteCharacter+Zt(n,t.quoteCharacter)+t.quoteCharacter),i}if(typeof n=="boolean"&&t.boolDisplay){const i=n?"true":"false";return t.boolDisplay[i]}return n},sr=t=>n=>{const i=we(t),s=i.useKeysAsHeaders?Object.keys(n[0]):i.columnHeaders;let y=tr(le(""),rr(i),nr(i),ir(i,s),ar(i,s,n));if(k(y).length<1)throw new Vt("Output is empty. Is your data formatted correctly?");return y},ur=t=>n=>{if(!window)throw new Qt("Downloading only supported in a browser environment.");const i=we(t),s=k(n),y=i.useTextFile?"plain":"csv",h=i.useTextFile?"txt":"csv";let v=new Blob([s],{type:`text/${y};charset=utf8;`}),u=document.createElement("a");u.download=`${i.filename}.${h}`,u.href=URL.createObjectURL(v),u.setAttribute("visibility","hidden"),document.body.appendChild(u),u.click(),document.body.removeChild(u)},Ke={};(function(t){(function(n,i){i(t)})(typeof globalThis<"u"?globalThis:typeof self<"u"?self:V,function(n){Object.defineProperty(n,"__esModule",{value:!0}),n.default=n.toXML=void 0;function i(r){return h(r)||y(r)||E(r)||s()}function s(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function y(r){if(typeof Symbol<"u"&&r[Symbol.iterator]!=null||r["@@iterator"]!=null)return Array.from(r)}function h(r){if(Array.isArray(r))return m(r)}function v(r,e){var o=Object.keys(r);if(Object.getOwnPropertySymbols){var f=Object.getOwnPropertySymbols(r);e&&(f=f.filter(function(w){return Object.getOwnPropertyDescriptor(r,w).enumerable})),o.push.apply(o,f)}return o}function u(r){for(var e=1;e<arguments.length;e++){var o=arguments[e]!=null?arguments[e]:{};e%2?v(Object(o),!0).forEach(function(f){j(r,f,o[f])}):Object.getOwnPropertyDescriptors?Object.defineProperties(r,Object.getOwnPropertyDescriptors(o)):v(Object(o)).forEach(function(f){Object.defineProperty(r,f,Object.getOwnPropertyDescriptor(o,f))})}return r}function j(r,e,o){return e in r?Object.defineProperty(r,e,{value:o,enumerable:!0,configurable:!0,writable:!0}):r[e]=o,r}function c(r,e){return M(r)||x(r,e)||E(r,e)||d()}function d(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function E(r,e){if(r){if(typeof r=="string")return m(r,e);var o=Object.prototype.toString.call(r).slice(8,-1);if(o==="Object"&&r.constructor&&(o=r.constructor.name),o==="Map"||o==="Set")return Array.from(r);if(o==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(o))return m(r,e)}}function m(r,e){(e==null||e>r.length)&&(e=r.length);for(var o=0,f=new Array(e);o<e;o++)f[o]=r[o];return f}function x(r,e){var o=r==null?null:typeof Symbol<"u"&&r[Symbol.iterator]||r["@@iterator"];if(o!=null){var f=[],w=!0,R=!1,C,A;try{for(o=o.call(r);!(w=(C=o.next()).done)&&(f.push(C.value),!(e&&f.length===e));w=!0);}catch(P){R=!0,A=P}finally{try{!w&&o.return!=null&&o.return()}finally{if(R)throw A}}return f}}function M(r){if(Array.isArray(r))return r}function T(r){"@babel/helpers - typeof";return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?T=function(o){return typeof o}:T=function(o){return o&&typeof Symbol=="function"&&o.constructor===Symbol&&o!==Symbol.prototype?"symbol":typeof o},T(r)}var S={ARRAY:"array",BOOLEAN:"boolean",DATE:"date",FUNCTION:"function",JSTOXML_OBJECT:"jstoxml-object",NULL:"null",NUMBER:"number",OBJECT:"object",STRING:"string"},N=[S.STRING,S.NUMBER,S.BOOLEAN],l='<?xml version="1.0" encoding="UTF-8"?>',a=["_selfCloseTag","_attrs"],b=function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"",o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;return e.repeat(o)},B=function(e){return Array.isArray(e)&&S.ARRAY||T(e)===S.OBJECT&&e!==null&&e._name&&S.JSTOXML_OBJECT||e instanceof Date&&S.DATE||e===null&&S.NULL||T(e)},I=function(e){return e.startsWith("<![CDATA[")},X=function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"",o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},f=arguments.length>2?arguments[2]:void 0,w=e;if(T(e)===S.STRING){if(I(e))return e;var R=new RegExp("(".concat(Object.keys(o).join("|"),")(?!(\\w|#)*;)"),"g");w=String(e).replace(R,function(C,A){return o[A]||""})}return typeof f=="function"?f(w):w},G=function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},o=arguments.length>1?arguments[1]:void 0,f=arguments.length>2?arguments[2]:void 0,w=arguments.length>3?arguments[3]:void 0,R=Array.isArray(e)?e:Object.entries(e).map(function(C){var A=c(C,2),P=A[0],q=A[1];return j({},P,q)});return R.reduce(function(C,A){var P=Object.keys(A)[0],q=A[P];if(T(f)===S.FUNCTION){var ie=f(P,q);if(ie)return C}var J=o?X(q,o):q,pe=!w&&J===!0?"":'="'.concat(J,'"');return C.push("".concat(P).concat(pe)),C},[])},O=function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},o=arguments.length>1?arguments[1]:void 0,f=arguments.length>2?arguments[2]:void 0,w=arguments.length>3?arguments[3]:void 0,R=G(e,o,f,w);if(R.length===0)return"";var C=R.join(" ");return" ".concat(C)},U=function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return Object.keys(e).map(function(o){return{_name:o,_content:e[o]}})},ce=function(e){return N.includes(B(e))},fe=function(e){return!e.match("<")},de=function(e){var o=e.header,f=e.isOutputStart,w=o&&f;if(!w)return"";var R=T(o)===S.BOOLEAN;return R?l:o},ne={"<":"&lt;",">":"&gt;","&":"&amp;",'"':"&quot;"},oe=function r(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},f=o.depth,w=f===void 0?0:f,R=o.indent,C=o._isFirstItem,A=o._isOutputStart,P=A===void 0?!0:A,q=o.header,ie=o.attributeReplacements,J=ie===void 0?{}:ie,pe=o.attributeFilter,xe=o.attributeExplicitTrue,Ye=xe===void 0?!1:xe,je=o.contentReplacements,me=je===void 0?{}:je,Oe=o.contentMap,_e=o.selfCloseTags,Ve=_e===void 0?!0:_e,ze=typeof J=="boolean"&&!J,Qe=ze?{}:u(u({},ne),J),Ze=typeof me=="boolean"&&!me,De=Ze?{}:u(u({},ne),me),Re=typeof R=="string",ve=b(R,w),et=B(e),Ce=de({header:q,indent:R,depth:w,isOutputStart:P}),ae=P&&!Ce&&C&&w===0,Ae=Re&&!ae?`
`:"",F="";switch(et){case S.JSTOXML_OBJECT:{var $=e._name,K=e._content;if(K===null&&typeof Oe!="function"){F="".concat(Ae).concat(ve).concat($);break}var tt=Array.isArray(K)&&K.every(ce);if(tt){var rt=K.map(function(L){return r({_name:$,_content:L},u(u({},o),{},{depth:w,_isOutputStart:!1}))});return rt.join("")}if(a.includes($))break;var Q=r(K,u(u({},o),{},{depth:w+1,_isOutputStart:ae})),nt=B(Q),ot=fe(Q),it=I(Q),Le="".concat(Ae).concat(ve);if($==="_comment"){F+="".concat(Le,"<!-- ").concat(K," -->");break}var Ne=nt==="undefined"||Q==="",at=Ve,ke=e._selfCloseTag,Be=T(ke)===S.BOOLEAN?Ne&&ke:Ne&&at,st=Be?"/":"",ut=O(e._attrs,Qe,pe,Ye),lt="<".concat($).concat(ut).concat(st,">"),ct=Re&&!ot&&!it?`
`.concat(ve):"",ft=Be?"":"".concat(Q).concat(ct,"</").concat($,">");F+="".concat(Le).concat(lt).concat(ft);break}case S.OBJECT:{var Pe=Object.keys(e),dt=Pe.map(function(L,Z){var ge=u(u({},o),{},{_isFirstItem:Z===0,_isLastItem:Z+1===Pe.length,_isOutputStart:ae}),D={_name:L};if(B(e[L])===S.OBJECT){a.forEach(function(ye){var Me=e[L][ye];typeof Me<"u"&&(D[ye]=Me,delete e[L][ye])});var vt=typeof e[L]._content<"u";if(vt&&Object.keys(e[L]).length>1){var Fe=Object.assign({},e[L]);delete Fe._content,D._content=[].concat(i(U(Fe)),[e[L]._content])}}typeof D._content>"u"&&(D._content=e[L]);var gt=r(D,ge);return gt},o);F=dt.join("");break}case S.FUNCTION:{var pt=e(o);F=r(pt,o);break}case S.ARRAY:{var mt=e.map(function(L,Z){var ge=u(u({},o),{},{_isFirstItem:Z===0,_isLastItem:Z+1===e.length,_isOutputStart:ae});return r(L,ge)});F=mt.join("");break}default:{F=X(e,De,Oe);break}}return"".concat(Ce).concat(F)};n.toXML=oe;var p={toXML:oe};n.default=p})})(Ke);var We={exports:{}};(function(t,n){(function(i,s){s()})(V,function(){function i(c,d){return typeof d>"u"?d={autoBom:!1}:typeof d!="object"&&(console.warn("Deprecated: Expected third argument to be a object"),d={autoBom:!d}),d.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(c.type)?new Blob(["\uFEFF",c],{type:c.type}):c}function s(c,d,E){var m=new XMLHttpRequest;m.open("GET",c),m.responseType="blob",m.onload=function(){j(m.response,d,E)},m.onerror=function(){console.error("could not download file")},m.send()}function y(c){var d=new XMLHttpRequest;d.open("HEAD",c,!1);try{d.send()}catch{}return 200<=d.status&&299>=d.status}function h(c){try{c.dispatchEvent(new MouseEvent("click"))}catch{var d=document.createEvent("MouseEvents");d.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),c.dispatchEvent(d)}}var v=typeof window=="object"&&window.window===window?window:typeof self=="object"&&self.self===self?self:typeof V=="object"&&V.global===V?V:void 0,u=v.navigator&&/Macintosh/.test(navigator.userAgent)&&/AppleWebKit/.test(navigator.userAgent)&&!/Safari/.test(navigator.userAgent),j=v.saveAs||(typeof window!="object"||window!==v?function(){}:"download"in HTMLAnchorElement.prototype&&!u?function(c,d,E){var m=v.URL||v.webkitURL,x=document.createElement("a");d=d||c.name||"download",x.download=d,x.rel="noopener",typeof c=="string"?(x.href=c,x.origin===location.origin?h(x):y(x.href)?s(c,d,E):h(x,x.target="_blank")):(x.href=m.createObjectURL(c),setTimeout(function(){m.revokeObjectURL(x.href)},4e4),setTimeout(function(){h(x)},0))}:"msSaveOrOpenBlob"in navigator?function(c,d,E){if(d=d||c.name||"download",typeof c!="string")navigator.msSaveOrOpenBlob(i(c,E),d);else if(y(c))s(c,d,E);else{var m=document.createElement("a");m.href=c,m.target="_blank",setTimeout(function(){h(m)})}}:function(c,d,E,m){if(m=m||open("","_blank"),m&&(m.document.title=m.document.body.innerText="downloading..."),typeof c=="string")return s(c,d,E);var x=c.type==="application/octet-stream",M=/constructor/i.test(v.HTMLElement)||v.safari,T=/CriOS\/[\d]+/.test(navigator.userAgent);if((T||x&&M||u)&&typeof FileReader<"u"){var S=new FileReader;S.onloadend=function(){var a=S.result;a=T?a:a.replace(/^data:[^;]*;/,"data:attachment/file;"),m?m.location.href=a:location=a,m=null},S.readAsDataURL(c)}else{var N=v.URL||v.webkitURL,l=N.createObjectURL(c);m?m.location=l:location.href=l,m=null,setTimeout(function(){N.revokeObjectURL(l)},4e4)}});v.saveAs=j.saveAs=j,t.exports=j})})(We);var lr=We.exports;const be=yt(lr),cr=({table:t,appId:n,metaData:i,bulkActions:s,tableStore:y,refetch:h})=>{H.debug(n,i);const v=Et(),u=y.table,j=y.columns;let c="csv";const[d,E]=_.useState(c),[m,x]=_.useState(!1),M=_.useMemo(()=>xt(),[]),T=Bt(n),S=j.filter(p=>p.lookup!==void 0&&T!==void 0&&T[p.columnName]!==void 0).map(p=>{if(T!==void 0&&T[p.columnName]!==void 0){const r={};return r[p.columnName]=T[p.columnName],r}else return null});H.debug("lookupColumns",S);const N=(p,r)=>{if(T!==void 0&&T[p]!==void 0){const e=T[p].filter(o=>o.key===r);if(Array.isArray(e)&&e.length===1)return e[0].value}return r},l=t.getSelectedRowModel().rows,a=l.map(p=>{const r={};return Object.keys(p.original).map(e=>{T!==void 0&&T[e]!==void 0?r[e]=N(e,p.original[e]):r[e]=p.original[e]}),r});H.debug(a),t.getAllColumns();const b=()=>{var p,r;return(i==null?void 0:i.src)===void 0?n:i.src.app_id&&((r=(p=i==null?void 0:i.app)==null?void 0:p.app[0])==null?void 0:r.app_title)!==""?i.app.app[0].app_title:i.src.dbs?i.src.tbl:n},B=we({filename:b(),fieldSeparator:",",decimalSeparator:".",useKeysAsHeaders:!0}),I=p=>{const r={};if(i.primary_key&&Array.isArray(i.primary_key))for(let e=0;e<i.primary_key.length;e++){const o=i.primary_key[e];r[o]=p[o]}return r},X=p=>{var r,e,o;for(let f=0;f<((r=i==null?void 0:i.columns)==null?void 0:r.length);f++)if(((e=i==null?void 0:i.columns[f])==null?void 0:e.column_name)===p)return(o=i==null?void 0:i.columns[f])==null?void 0:o.data_type;return"varchar"},G=async()=>{},O=()=>{const p=sr(B)(a);ur(B)(p)},U=()=>{be(new Blob([JSON.stringify(a)],{type:"text/json;charset=utf-8"}),b()+".json")};_.useRef();const ce=()=>{const p=l.map(e=>({row:e.original})),r=Ke.toXML({table:p});be(new Blob([r],{type:"text/plain;charset=utf-8"}),b()+".xml")},fe=()=>{const p=St(n);H.debug(p);let r="insert into "+p.tbl+" (";for(const e in a[0])r+=e+",";r=r.slice(0,-1)+") values ";for(let e=0;e<a.length;e++){const o=a[e];r+="(";for(const f in o){const w=wt(X(f));o[f]===null?r+="null,":w==="number"?r+=o[f]+",":r+="'"+o[f]+"',"}r=r.slice(0,-1),r+="),"}r=r.slice(0,-1)+";",be(new Blob([r],{type:"text/plain;charset=utf-8"}),b()+".sql")},de=()=>{for(let p=0;p<a.length;p++){const r=I(a[p]);Nt(n,r,e=>{if(e!=null&&e.code&&(e!=null&&e.message))switch(e.code){case"ok":se(e.message,{variant:"success"}),h();break;default:H.error(e),se(e.message??he.contactSupport,{variant:"error"})}else H.error(e),se(he.contactSupport,{variant:"error"})},e=>{H.error("error",e),se(e??he.contactSupport,{variant:"error"})})}t.setRowSelection({})},ne=()=>null,oe=()=>null;return _.useState(0),_.useState(0),g.jsxs(g.Fragment,{children:[g.jsx(Ge,{variant:"popover",popupId:M,children:p=>{var r;return g.jsxs(Te,{children:[g.jsx(ue,{variant:"contained",endIcon:g.jsx(At,{}),...Gt(p),children:"Bulk Actions"}),y.state.relTab===!0&&g.jsx(ue,{variant:"contained",startIcon:g.jsx(jt,{}),sx:{marginLeft:"10px"},onClick:()=>{v(ht({appId:n}))},children:"Back"}),g.jsx(Pt,{...Jt(p),anchorOrigin:{vertical:"bottom",horizontal:"left"},transformOrigin:{vertical:"top",horizontal:"left"},sx:{boxShadow:"0px 5px 5px -3px rgba(0,0,0,0.2),0px 8px 10px 1px rgba(0,0,0,0.14),0px 3px 14px 2px rgba(0,0,0,0.12)"},children:g.jsxs(Te,{sx:{display:"grid",gap:"20px",padding:"20px"},children:[l.length===0&&g.jsx(Ft,{sx:{textAlign:"center",marginTop:"10px"},children:"No rows selected"}),g.jsxs(It,{value:d,onChange:(e,o)=>{E(o),e.stopPropagation()},children:[ne(),s.csv&&g.jsx(W,{value:"csv",label:"Export to CSV",control:g.jsx(Y,{})}),s.json&&g.jsx(W,{value:"json",label:"Export to JSON",control:g.jsx(Y,{})}),oe(),s.xml&&g.jsx(W,{value:"xml",label:"Export to XML",control:g.jsx(Y,{})}),s.sql&&!bt(n)&&g.jsx(W,{value:"sql",label:"Export to SQL",control:g.jsx(Y,{})}),((r=i==null?void 0:i.privs)==null?void 0:r.delete)&&!Tt(i)&&(s==null?void 0:s.delete)===!0&&u.transactions.delete&&g.jsx(W,{value:"delete",label:"Delete permanently",control:g.jsx(Y,{})}),(s.select??!1)&&g.jsx(W,{value:"select",label:"Add selected records",control:g.jsx(Y,{})})]}),g.jsx(ue,{variant:"contained",onClick:()=>{switch(d){case"pdf":G();break;case"csv":O();break;case"json":U();break;case"excel":break;case"xml":ce();break;case"sql":fe();break;case"delete":x(!0);break}},disabled:l.length===0,children:"Apply"})]})})]})}}),g.jsx(kt,{title:"Delete selected row?",message:"Are you sure you want to delete the selected row? This action cannot be undone!",open:m,setOpen:x,onConfirm:()=>{de()},theme:Ot})]})},Jr=({table:t,metaData:n,appId:i,bulkActions:s,hasBulkActions:y,tableStore:h,refetch:v,showForm:u})=>{var c;const j=h.table;return g.jsxs(Te,{sx:{display:"flex",flexWrap:"nowrap",gap:"8px",alignItems:"center",whiteSpace:"nowrap"},className:"pp-toolbar-buttons",children:[g.jsx(_t,{arrow:!0,title:"Refresh Table",className:"ppToolbarRefreshIcon",children:g.jsx(Mt,{onClick:()=>v(),children:g.jsx(Rt,{})})}),((c=j==null?void 0:j.transactions)==null?void 0:c.insert)&&g.jsx(ue,{variant:"contained",startIcon:g.jsx(Lt,{}),onClick:()=>{u(null,Ct.INSERT)},children:"New Record"}),y&&g.jsx(cr,{table:t,appId:i,metaData:n,bulkActions:s,tableStore:h,refetch:v})]})};export{Jr as default};
